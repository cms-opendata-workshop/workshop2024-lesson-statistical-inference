<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Statistical inference with Combine: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="dpoa-logo" alt="CMS DPOA logo" src="../assets/images/dpoa-logo.png"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="CMS DPOA small logo" src="../assets/images/dpoa-logo-sm.png">
</div>
    <div class="lesson-title-md">
      Statistical inference with Combine
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Statistical inference with Combine
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr></ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Statistical inference with Combine
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-statinference.html">1. Introduction to statistical inference</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="03-limits.html">2. Limits</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="04-combine.html">3. The CMS Combine statistical analysis and combination software</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="05-challenge.html">4. Limit calculation challenge</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
</ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-statinference"><p>Content from <a href="01-statinference.html">Introduction to statistical inference</a></p>
<hr>
<p>Last updated on 2024-08-01 |

        <a href="https://github.com/cms-opendata-workshop/workbench-template-md/edit/main/episodes/01-statinference.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What does statistical inference mean?</li>
<li>What is a statistical model and a likelihood?</li>
<li>What types of statistical models do we use?</li>
<li>How do we incorporate constraints on nuisance parameters?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the role of statistical inference in an analysis and
related terminology.</li>
<li>Understand the concept of a statistical model and a likelihood.</li>
<li>Learn the types of statistical models generally used in
analyses.</li>
<li>Learn how the constraints on nuisance parameters are
implemented.</li>
<li>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="reference-material" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="reference-material" class="callout-inner">
<h3 class="callout-title">Reference Material<a class="anchor" aria-label="anchor" href="#reference-material"></a>
</h3>
<div class="callout-content">
<ul>
<li><a href="https://github.com/cms-analysis/HiggsAnalysis-CombinedLimit/wiki" class="external-link">Combine
Manual</a></li>
<li><a href="https://indico.cern.ch/event/747340/timetable/" class="external-link">Combine
Tutorial at LPC</a></li>
<li>
<a href="https://indico.cern.ch/event/358542/" class="external-link">Practical Statistics
for LHC Physicists</a> - Three CERN Academic Lectures by Harrison
Prosper</li>
<li>
<a href="http://indico.cern.ch/getFile.py/access?contribId=41&amp;sessionId=1&amp;resId=0&amp;materialId=slides&amp;confId=112319" class="external-link">Statistics
in Theory</a> - A lecture by Bob Cousins</li>
<li>
<a href="http://indico.in2p3.fr/materialDisplay.py?contribId=15&amp;materialId=slides&amp;confId=750" class="external-link">RooFit</a>
- Slides by Wouter Verkerke, one of the <a href="https://twiki.cern.ch/twiki/bin/view/CMS/RooFit" class="external-link">RooFit</a>
developers</li>
<li>
<a href="http://root.cern.ch/root/html/tutorials/roofit/index.html" class="external-link">RooFit
Tutorials</a> - A set of macros that showcase all major features of
RooFit</li>
<li>
<a href="https://twiki.cern.ch/twiki/pub/RooStats/WebHome/RooStats_UsersGuide.pdf" class="external-link">RooStats
Manual</a> - A concise, clear, summary of statistics concepts and
definitions</li>
<li>
<a href="http://indico.cern.ch/getFile.py/access?contribId=0&amp;sessionId=1&amp;resId=0&amp;materialId=slides&amp;confId=118720" class="external-link">RooStats
Tutorial</a> - Tutorial by Kyle Cranmer, one of the RooStats
developers</li>
<li>
<a href="http://root.cern.ch/root/html/tutorials/roostats/index.html" class="external-link">RooStats
Tutorials</a> - A set of macros that showcase all major features of
RooStats</li>
<li>
<a href="https://twiki.cern.ch/twiki/bin/viewauth/CMS/SWGuideCMSDataAnalysisSchoolStatistics2014" class="external-link">CMS
DAS 2014 Statistics Exercise</a> - A tutorial on statistics as used in
CMS</li>
<li>
<a href="https://cds.cern.ch/record/1379837" class="external-link">Procedure for the LHC
Higgs boson search combination in Summer 2011</a> - Paper describing LHC
statistical procedures</li>
<li>
<a href="https://github.com/cms-analysis/HiggsAnalysis-CombinedLimit" class="external-link">Combine
Github</a> - Github repository for combine</li>
<li>
<a href="https://indico.cern.ch/event/653271/" class="external-link">LPC statistics
course</a> - Lectures by Harrison Prosper and Ulrich Heintz, fall
2017</li>
</ul>
</div>
</div>
</div>
<div id="terminology-and-conventions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="terminology-and-conventions" class="callout-inner">
<h3 class="callout-title">Terminology and Conventions<a class="anchor" aria-label="anchor" href="#terminology-and-conventions"></a>
</h3>
<div class="callout-content">
<p>Here we give pragmatic definitions for a few basic concepts that we
will use.</p>
<ul>
<li>
<strong>observable</strong> - something you measure in an
experiment, for example, a particle’s momentum. Often, a function of
measured quantities, for example, an invariant mass of several
particles.</li>
<li>
<strong>global observable</strong> or <strong>auxiliary
observable</strong> - an observable from another measurement, for
example, the integrated luminosity.</li>
<li>
<strong>model</strong> - a set of probability functions (PFs)
describing the distributions of observables or functions of observables.
The probability functions are called probability density functions
(PDFs) if the observables are continuous and probability mass functions
(PMF) if the observables are discrete. In the Bayesian approach, the
model also includes the prior density.</li>
<li>
<strong>model parameter</strong> - any variable in your model that
is not an observable.</li>
<li>
<strong>parameter of interest (POI)</strong> - a model parameter of
current interest, for example, a cross section.</li>
<li>
<strong>nuisance parameter</strong> - every model parameter other
than your parameter (or parameters) of interest.</li>
<li>
<strong>data</strong> or <strong>data set</strong> - a set of values
of observables, either measured in an experiment or simulated.</li>
<li>
<strong>likelihood</strong> - a model computed for a particular data
set.</li>
<li>
<strong>hypothesis</strong> - a model in which all quantities are
specified: observables, model parameters, and prior PDFs (in case of
Bayesian inference).</li>
<li>
<strong>prior</strong> - a probability or probability density for an
observable or a model parameter that is independent of the data set.
Priors are a key feature of Bayesian inference. However, priors can be
used in frequentist inference only if they can be interpreted as
relative frequencies.</li>
<li>
<strong>Bayesian</strong> - a school of statistical inference based
on the likelihood and a prior.</li>
<li>
<strong>frequentist</strong> - a school of statistical inference
based on the likelihood only.</li>
</ul>
</div>
</div>
</div>
<p>Statistical inference is the last step of an analysis and plays a
crucial role in interpreting the experimental data. It involves using
statistical methods to draw conclusions about the underlying physical
processes based on observed data. This process includes defining a
statistical model, constructing a likelihood function, and employing
techniques such as hypothesis testing and parameter estimation to
extract meaningful insights. Let’s start with the concept of a
statistical model.</p>
<section><h2 class="section-heading" id="statistical-model">Statistical model<a class="anchor" aria-label="anchor" href="#statistical-model"></a>
<a class="anchor" aria-label="anchor" href="#statistical-model"></a>
</h2>
<hr class="half-width">
<p><strong>Statistical model</strong> is the mathematical framework used
to describe and make inferences about the underlying processes that
generate observed data. It encodes the probabilistic dependence of the
observed quantities (i.e. data) on parameters of the model. These
parameters are not directly observable but can be inferred from
experimental data. They include</p>
<ul>
<li>
<strong>parameters of interest (POI), <span class="math inline">\(\vec{\mu}\)</span>:</strong> The quantities we are
interested in estimating or testing. Examples are cross section, signal
strength modifier, resonance mass, …</li>
<li>
<strong>nuisance parameters, <span class="math inline">\(\vec{\nu}\)</span>:</strong> parameters that are
not of direct interest, but required to explain data. These could be
uncertainties of experimental or theoretical origin, such as detector
effects, background measurements, lumi calibration, cross-section
calculation.</li>
</ul>
<p>Data are also partitioned into two:</p>
<ul>
<li>
<strong>primary observables, <span class="math inline">\(\vec{x}\)</span></strong>: Appear in components of
the model that contain the POIs.</li>
<li>
<strong>auxiliary observables, <span class="math inline">\(\vec{y}\)</span></strong>: Appear only in
components of the model that contain the nuisance parameters.</li>
</ul>
<p><strong>Likelihood</strong> is the value of the statistical model at
a given fixed set of data as a function of parameters.</p>
<p>Statistical model provides the complete mathematical description of
an analysis and is the starting point of any interpretation.</p>
<p>Now let’s express this mathamatically. Our statistical model be
described as <span class="math inline">\(p(\rm{data,\vec{\Phi}})\)</span> where <span class="math inline">\(\vec{\Phi}\)</span> are the model parameters. For
the sake of numerical efficiency, we can factorize it into two
parts:</p>
<p><span class="math display">\[p(\vec{x},\vec{y};\vec{\Phi}) =
p(\vec{x};\vec{\mu},\vec{\nu}) \prod_k
p_k(\vec{y}_k;\vec{\nu}_k)\]</span></p>
<ul>
<li>
<strong>primary component:</strong> <span class="math inline">\(p(\vec{x};\vec{\mu},\vec{\nu})\)</span>. Relates
POI to primary observables.</li>
<li>
<strong>auxiliary component:</strong> <span class="math inline">\(\prod_k p_k(\vec{y}_k;\vec{\nu}_k)\)</span>.
Constrains nuisance parameters.</li>
</ul>
<p>Likelihood function is constructed by evaluating <span class="math inline">\(p(\rm{data,\vec{\Phi}})\)</span> on a dataset:</p>
<p><span class="math display">\[L(\vec{\Phi}) = \prod_d
p(\vec{x}_d;\vec{\mu},\vec{\nu}) \prod_k
p_k(\vec{y}_k;\vec{\nu}_k)\]</span></p>
<p>where <span class="math inline">\(d\)</span> runs over all entries in
data.</p>
<p>This likelihood can be used in both frequentist and Bayesian
calculations.</p>
</section><section><h2 class="section-heading" id="types-of-statistical-models">Types of statistical models<a class="anchor" aria-label="anchor" href="#types-of-statistical-models"></a>
<a class="anchor" aria-label="anchor" href="#types-of-statistical-models"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="counting-analysis">Counting analysis<a class="anchor" aria-label="anchor" href="#counting-analysis"></a>
</h3>
<p>A counting analysis is one for which the statistical model has only
one primary observable, namely the total event count in a single channel
that includes multiple sources of signal and background. In the
following, the primary observable is labeled <span class="math inline">\(n\)</span>. The probability to observe <span class="math inline">\(n\)</span> events is described by a Poisson
distribution,</p>
<p><span class="math display">\[p(n;\lambda(\vec{\mu}, \vec{\nu}))
=\lambda^n\frac{e^{-\lambda}}{n!}\]</span></p>
<p>where the expected value, <span class="math inline">\(\lambda\)</span>, can be a function of one or more
parameters, and represents the total number of expected signal and
background events.</p>
<p>For our analyses, we usually express <span class="math inline">\(\lambda\)</span>, the expected number of events
as:</p>
<p><span class="math display">\[\lambda \equiv n_{exp} = \mu
\rm{\sigma_{sig}^{eff}} L + \rm{\sigma_{bg}^{eff}} L\]</span></p>
<p>Here <span class="math inline">\(\rm{\sigma_{sig}^{eff}}\)</span> and
<span class="math inline">\(\rm{\sigma_{bg}^{eff}}\)</span> are signal
and background effective cross sections (i.e. cross section times
selection efficiency times detector acceptance) and <span class="math inline">\(L\)</span> is the integrated luminosity. Our
parameter of interest here is <span class="math inline">\(\mu\)</span>,
the signal strength modifier. The estimated value of <span class="math inline">\(\mu\)</span> would be able to tell us if the
signal is discovered, excluded or still out of reach.</p>
</div>
<div class="section level3">
<h3 id="template-shape-analysis">Template shape analysis<a class="anchor" aria-label="anchor" href="#template-shape-analysis"></a>
</h3>
<p>A shape analysis is defined as one that incorporates one or more
primary observables, beyond a single number of events.</p>
<p>A template-based shape analysis is one in which the observable in
each channel is partitioned into <span class="math inline">\(N_B\)</span> bins. The number of events <span class="math inline">\(n_b\)</span> in the data that fall within each bin
<span class="math inline">\(b\)</span> (with <span class="math inline">\(b\)</span> running from 1 to <span class="math inline">\(N_B\)</span>) is considered as an independent
Poisson process. The model becomes a product of Poisson
probabilities:</p>
<p><span class="math display">\[p(x;\vec{\mu}, \vec{\nu}) =
\prod_{b=1}^{N_B} P(n_b;\lambda (\vec{\mu},\vec{\nu}))\]</span></p>
<p>In a sense, this is a generalization of the counting analysis.
Template shape is the model most used by LHC analyses, as we usually do
not know an analytical expression that would describe how our signal or
background processes are distributed.</p>
<p>Technically, input to this model is usually given as histograms.
Data, backgrounds, signals and variations on backgrounds and signals are
all provided as histograms. An example can be seen in the figure below,
where sigma and alpha are systematic uncertainties:</p>
<figure><img src="../fig/template_shape_analysis.png" style="width:50.0%" alt="Plot showing a template shape model with uncertainties" class="figure mx-auto d-block"><div class="figcaption">Plot showing a template shape model with
uncertainties</div>
</figure>
</div>
<div class="section level3">
<h3 id="parametric-shape-analysis">Parametric shape analysis<a class="anchor" aria-label="anchor" href="#parametric-shape-analysis"></a>
</h3>
<p>A parametric shape analysis is one that uses analytic functions
rather than histograms to describe the probability distributions of
continuous primary observables. In these cases, the primary observable
<span class="math inline">\(x\)</span> in each channel can be univariate
or multivariate. For example, in the measurements of Higgs boson cross
sections in the four-lepton decay mode, the primary observable is
bivariate composed of the invariant mass of the four leptons and a
kinematic discriminator designed to separate the signal and background
processes. The data in parametric shape analyses can be binned, as in
the case of template-based analyses, or unbinned. Uncertainties
affecting the expected distributions of the signal and background
processes can be implemented directly as uncertainties in the parameters
of those analytical functions.</p>
<p><span class="math display">\[p(x;\vec{\mu}, \vec{\nu}) = \sum_p
\frac{\lambda_p(\vec{\mu},\vec{\nu}) f_p(x; \vec{\mu},
\vec{\nu})}{\sum_p \lambda_p(\vec{\mu}, \vec{\nu})}\]</span></p>
<p>Here <span class="math inline">\(p\)</span> stands for process and
<span class="math inline">\(f_p(x; \vec{\mu}, \vec{\nu})\)</span> are
the probability density functions for each process. The figure below
shows an example, where sigma and alpha are the uncertainties on
parameters of the analytic function.</p>
<figure><img src="../fig/parametric_shape_analysis.png" style="width:50.0%" alt="Plot showing a parametric shape model with uncertainties" class="figure mx-auto d-block"><div class="figcaption">Plot showing a parametric shape model with
uncertainties</div>
</figure>
</div>
</section><section><h2 class="section-heading" id="handling-nuisance-parameters">Handling nuisance parameters<a class="anchor" aria-label="anchor" href="#handling-nuisance-parameters"></a>
<a class="anchor" aria-label="anchor" href="#handling-nuisance-parameters"></a>
</h2>
<hr class="half-width">
<p>When writing the auxiliary component, we usually do not explicitly
input the auxiliary data. Instead, we can use priors that encapsulate
the knowledge or constraints obtained from the auxiliary data. For
example, if auxiliary experiments have measured a nuisance parameter
<span class="math inline">\(\nu\)</span> with a certain mean and
uncertainty <span class="math inline">\(\sigma\)</span>, this
information can be used to define a prior distribution.</p>
<p>Let’s give a concrete example for luminosity. Imagine a counting
analysis, where the primary component is a Poisson. Remember that the
number of expected events in that Poisson could be expressed as</p>
<p><span class="math display">\[n_{exp} = \mu \rm{\sigma_{sig}^{eff}} L
+ \rm{\sigma_{bg}^{eff}} L\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the signal strength
modifier, <span class="math inline">\(\rm{\sigma_{sig}^{eff}}\)</span>
and <span class="math inline">\(\rm{\sigma_{bg}^{eff}}\)</span> are
signal and background effective cross sections and <span class="math inline">\(L\)</span> is the integrated luminosity. Suppose
that, in a different study, we have measured that there is a 2.5%
uncertainty on luminosity, which would directly effect the expected
number of events:</p>
<p><span class="math display">\[L \rightarrow L(1 +
0.025)^\nu\]</span></p>
<p>When <span class="math inline">\(\nu = 0\)</span>, no change happens
in <span class="math inline">\(L\)</span>, and consequently <span class="math inline">\(n_{exp}\)</span>. When <span class="math inline">\(\nu = \pm 1\)</span>, we have the <span class="math inline">\(+/-\)</span> effect. We apply a Gaussian
constraint as</p>
<p><span class="math display">\[\pi(\nu_0, \nu) = \pi(0 | \nu) -
e^{-\frac{1}{2}\nu^2}\]</span></p>
<p>Hence, the nuisance parameter for luminosity uncertainty is
<strong>log-normally distributed</strong>.</p>
<p>For observed count <span class="math inline">\(N\)</span>, the
likelihood becomes</p>
<p><span class="math display">\[\mathcal{L}(\mu, \nu) = \frac{n_{exp}^N
e^{-n_{exp}}}{N!}e^{-\frac{1}{2}\nu^2}\]</span></p>
<p>where</p>
<p><span class="math display">\[n_{exp} = \mu \rm{\sigma_{sig}^{eff}} L
\cdot 1.025^\nu + \rm{\sigma_{bg}^{eff}} L \cdot 1.025^\nu\]</span></p>
<p>In Bayesian analysis, we can marginalize over the nuisance parameters
by integrating them out of the posterior distribution. This approach
automatically accounts for the uncertainties in the nuisance parameters
based on the priors. In frequentist analysis, we can profile out the
nuisance parameters by finding the values that maximize the likelihood
for each fixed value of the POI.</p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-03-limits"><p>Content from <a href="03-limits.html">Limits</a></p>
<hr>
<p>Last updated on 2024-08-01 |

        <a href="https://github.com/cms-opendata-workshop/workbench-template-md/edit/main/episodes/03-limits.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 10 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are limits?</li>
<li>What are expected and observed limits?</li>
<li>How do we calculate limits?</li>
<li>
</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the concept of limits, expected limits, and observed
limits.</li>
<li>Familiarize with the steps of calculating limits.</li>
<li>Familiarize with the concepts of hypothesis testing, test statistic,
p-values and confidence level.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-are-limits">What are limits?<a class="anchor" aria-label="anchor" href="#what-are-limits"></a>
<a class="anchor" aria-label="anchor" href="#what-are-limits"></a>
</h2>
<hr class="half-width">
<p><strong>Limits</strong> are constraints placed on the parameters of a
theoretical model based on the experimental data. They help determine
the range within which new particles or interactions could exist.</p>
<p><strong>Observed limits:</strong> These are limits derived directly
from the experimental data. They represent the actual constraint on the
parameter of interest based on the measurements taken during the
experiment.</p>
<p><strong>Expected limits:</strong> These are limits based on simulated
data assuming no new phenomena exist (i.e., that the null hypothesis is
true). They provide a benchmark for comparing the observed limits to
what would be expected if only known physics were at play.</p>
</section><section><h2 class="section-heading" id="calculating-limits">Calculating limits<a class="anchor" aria-label="anchor" href="#calculating-limits"></a>
<a class="anchor" aria-label="anchor" href="#calculating-limits"></a>
</h2>
<hr class="half-width">
<p>The process of calculating limits typically involves the following
steps:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Define the statistical model and construct the
likelihood</strong> :</p></li>
<li>
<p><strong>Perform Hypothesis Testing</strong>:</p>
<ul>
<li>
<strong>Null hypothesis (or background-only hypothesis) (<span class="math inline">\(H_0\)</span>)</strong>: This hypothesis assumes
that there is no new physics, meaning the data can be fully explained by
the standard model or another established theory.</li>
<li>
<strong>Alternative hypothesis or signal+background hypothesis
(<span class="math inline">\(H_1\)</span>)</strong>: This hypothesis
posits the presence of new physics, implying deviations from the
predictions of the null hypothesis.</li>
<li>
<strong>Test statistic</strong>: Calculate a test statistic, such as
the profile likelihood ratio, which compares how well the data fits
under both <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>. The profile likelihood ratio is
defined as:<span class="math display">\[\lambda(\mu) =
\frac{\mathcal{L}(\mu, \hat{\hat{\nu}})}{\mathcal{L}(\hat{\mu},
\hat{\nu})}\]</span> where <span class="math inline">\(\mathcal{L}\)</span> is the likelihood function,
<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\nu\)</span> represent the parameters of interest
and nuisance parameters, <span class="math inline">\(\hat{\mu}\)</span>
and <span class="math inline">\(\hat{\nu}\)</span> are the best-fit
parameters, and <span class="math inline">\(\hat{\hat{\nu}}\)</span> (or
$ ()$) is the conditional maximum likelihood estimator of the nuisance
parameters given <span class="math inline">\(\mu\)</span>. Note that in
the current LHC analyses, we use more complex test statistics such as
the LHC-style test statistic. However, despite the added complexity, the
main idea is the same. The test statistic is evaluated for observed data
or pseudo-data</li>
<li>
<strong>p-value</strong>: Determine the p-value, which quantifies
the probability of obtaining data as extreme as observed under the null
hypothesis. A small p-value indicates that the null hypothesis is
unlikely.</li>
<li>
<strong>Confidence level</strong>: Set a confidence level (e.g.,
95%) to determine the exclusion limits. The confidence level represents
the probability that the true parameter values lie within the calculated
limits if the experiment were repeated many times.</li>
</ul>
</li>
<li>
<p><strong>Calculate limits</strong>: The p-values for the
signal-only and signal+BG hypotheses are combined in a certain way to
obtain limits. At the LHC, we use the so-called <strong><span class="math inline">\(\mathrm{CL_s}\)</span></strong> quantity.</p>
<ul>
<li>
<strong>Expected limits:</strong> Obtain by comparing observed data
with 1) signal MC + estimated BG and 2) with only estimated BG. Observed
limits check the consistency of the observation with the signal + BG
hypothesis and compares it to the BG-only hypothesis.</li>
<li>
<strong>Expected limits:</strong> Get the null hypothesis,
e.g. background estimation from simulation or a data-driven method.
Obtain the limits by comparing estimated BG with signal + estimated BG.
Useful for predicting the analysis sensitivity.</li>
</ul>
</li>
<li>
<p><strong>Compare and interpret</strong>:</p>
<ul>
<li>Compare the observed limits with the expected limits to interpret
the results. If the observed limits are significantly different from the
expected limits, this may indicate potential new physics.</li>
</ul>
</li>
</ol>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 --></section></section><section id="aio-04-combine"><p>Content from <a href="04-combine.html">The CMS Combine statistical analysis and combination software</a></p>
<hr>
<p>Last updated on 2024-08-01 |

        <a href="https://github.com/cms-opendata-workshop/workbench-template-md/edit/main/episodes/04-combine.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 10 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Combine?</li>
<li>How do I input a statistical model into Combine?</li>
<li>What tasks does Combine perform?</li>
<li>Can I use Combine outside CMS? Where can I find detailed
documentation?</li>
<li>What does it mean to publish a statistical model, and why is it so
important?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Get introduced to the Combine tool.</li>
<li>Learn the principles of how to input a statistical model</li>
<li>Learn the set of tasks performed by Combine.</li>
<li>Learn how to access information on how to run Combine outside CMS,
and access documentation.</li>
<li>Learn the concept of statistical model publication and how to access
the first model published by CMS.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<figure><img src="../fig/combinelogo.png" style="width:35.0%" class="figure mx-auto d-block"></figure><section><h2 class="section-heading" id="what-is-combine">What is Combine?<a class="anchor" aria-label="anchor" href="#what-is-combine"></a>
<a class="anchor" aria-label="anchor" href="#what-is-combine"></a>
</h2>
<hr class="half-width">
<p><strong>Combine</strong> is the statistical analysis software used in
CMS, built around the ROOT, RooFit and RooStats packages. It provides a
command-line interface to several common workflows used in HEP
statistical analysis. Combine provides a standardized access to these
workflows, which makes it a very practical and reliable tool. As of
2024, more than 90% of the analyses in CMS use Combine for statistical
inference.</p>
</section><section><h2 class="section-heading" id="models-and-the-datacard">Models and the datacard<a class="anchor" aria-label="anchor" href="#models-and-the-datacard"></a>
<a class="anchor" aria-label="anchor" href="#models-and-the-datacard"></a>
</h2>
<hr class="half-width">
<p>Combine implements the statistical model and the corresponding
likelihood in a RooFit-based custom class. The inputs to the model are
encapsulated in a human-readable configuration file called the
<strong>datacard</strong>. Datacard includes information such as</p>
<ul>
<li>signal and background processes, shapes and rates</li>
<li>systematic and statistical uncertainties incorporated as nuisance
parameters and their effects on the rates, along with their
correlations</li>
<li>multiplicative scale factors that modify the rate of a given process
in a given channel</li>
</ul>
<p>Combine supports building models for counting analyses, template
shape analyses and parametric shape analyses. Though the main datacard
syntax is similar for these three cases, there are minor differences
reflecting the model input. For example, in the case for a template
shape model, one needs to specify a ROOT file with input histograms, and
in the case of a parametric shape model, one needs to specify the
process probability distribution functions.</p>
<p>Constructing a datacard is usually the level most users input
information to Combine. However, there are some cases where the
statistical model requires modifications. An example case is where we
need a model with multiple parameters of interest associated with
different signal processes (e.g. measurement of signal strength
modifiers for two different Higgs production channels, gluon-gluon
fusion and vector boson fusion). Combine also allows to build custom
models by introducing modified model classes. Combine scales well with
model complexity, and therefore is a powerful tool for combining a large
number of analyses.</p>
</section><section><h2 class="section-heading" id="tasks-performed-by-combine">Tasks performed by Combine<a class="anchor" aria-label="anchor" href="#tasks-performed-by-combine"></a>
<a class="anchor" aria-label="anchor" href="#tasks-performed-by-combine"></a>
</h2>
<hr class="half-width">
<p>Combine is capable of performing many statistical tasks. The main
interface is with the command below</p>
<pre><code>combine &lt;datacard.[txt|root]&gt; -M &lt;method&gt;</code></pre>
<p>where one enters a datacard (either as text or in a ROOT-converted
format) and specifies the method pointing to a task.</p>
<p>Here is a set of methods used for extracting results:</p>
<ul>
<li>
<a href="http://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/commonstatsmethods/#computing-limits-with-toys" class="external-link"><strong>HybridNew:</strong></a>
compute modified frequentist limits with pseudo-data, p-values,
significance and confidence intervals with several options, –LHCmode
LHC-limits is the recommended one.</li>
<li>
<a href="http://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/commonstatsmethods/#asymptotic-frequentist-limits" class="external-link"><strong>AsymptoticLimits:</strong></a>
limits calculated according to the asymptotic formulas in
arxiv:1007.1727, valid for large event counts.</li>
<li>
<a href="http://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/commonstatsmethods/#asymptotic-significances" class="external-link"><strong>Significance:</strong></a>
simple profile likelihood approximation for calculating
significances.</li>
<li>
<a href="http://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/commonstatsmethods/#bayesian-limits-and-credible-regions" class="external-link"><strong>BayesianSimple:</strong></a>
and <a href="http://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/commonstatsmethods/#computing-the-observed-bayesian-limit-for-arbitrary-models" class="external-link"><strong>MarkovChainMC</strong></a>
compute Bayesian upper limits and credible intervals for simple and
arbitrary models.</li>
<li>
<a href="http://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/commonstatsmethods/#likelihood-fits-and-scans" class="external-link"><strong>MultiDimFit:</strong></a>
perform maximum likelihood fit, with multiple POIs, estimate CI from
likelihood scans.</li>
</ul>
<p>Combine also provides an extensive toolset for validation and
diagnosis:</p>
<ul>
<li>
<a href="https://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/commonstatsmethods/#goodness-of-fit-tests" class="external-link"><strong>GoodnessOfFit:</strong></a>
perform a goodness of fit test for models including shape information
using several GoF estimators (saturated, Kolmogorov-Smirnov,
Anderson-Darling)</li>
<li>
<a href="https://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/nonstandard/#nuisance-parameter-impacts" class="external-link"><strong>Impacts:</strong></a>
evaluate the shift in POI from ￼ variation for each nuisance
parameter.</li>
<li>
<a href="http://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/commonstatsmethods/#channel-compatibility" class="external-link"><strong>ChannelCompatibiltyCheck:</strong></a>
check how consistent are the individual channels of a combination
are</li>
<li>
<a href="https://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/part3/runningthetool/#generate-only" class="external-link"><strong>GenerateOnly:</strong></a>
generate random or Asimov pseudo-datasets for use as input to other
methods</li>
</ul></section><section><h2 class="section-heading" id="running-combine-and-detailed-references">Running Combine and detailed references<a class="anchor" aria-label="anchor" href="#running-combine-and-detailed-references"></a>
<a class="anchor" aria-label="anchor" href="#running-combine-and-detailed-references"></a>
</h2>
<hr class="half-width">
<p>In 2024 Combine tool became available to the public along with</p>
<ul>
<li>a detailed paper: <a href="https://arxiv.org/abs/2404.06614" class="external-link">CMS-CAT-23-001 /
arXiv:2404.06614</a> and a</li>
<li>detailed user manual: <a href="https://cms-analysis.github.io/HiggsAnalysis-Combined%20Limit/latest/" class="external-link">Combine
github pages</a>
</li>
</ul>
<p>The easiest way to run Combine is to use a Docker containerized
version of it (as we will do in the next exercise). The container can be
installed as:</p>
<pre><code>docker run --name combine -it gitlab-registry.cern.ch/cms-cloud/combine-standalone:&lt;tag&gt;</code></pre>
<p>where <code>&lt;tag&gt;</code> should be replaced by the latest tag,
which is currently <code>v9.2.1</code></p>
<p>There are also other ways, e.g. based on Conda or a standalone
compilation. All instructions are given in <a href="https://cms-analysis.github.io/HiggsAnalysis-CombinedLimit/latest/#slc6cc7-release-cmssw_8_1_x" class="external-link">this
documentation</a>.</p>
</section><section><h2 class="section-heading" id="publishing-statistical-models">Publishing statistical models<a class="anchor" aria-label="anchor" href="#publishing-statistical-models"></a>
<a class="anchor" aria-label="anchor" href="#publishing-statistical-models"></a>
</h2>
<hr class="half-width">
<p>Statistical models of our numerous physics analyses would provide an
excellent resource for the community.<br>
Publishing them will help maximize the scientific impact of the
analyses, and facilitate</p>
<ul>
<li>Preservation and documentation: the mathematical construction of the
analysis in full detail.</li>
<li>Combination of multiple analyses</li>
<li>Reinterpretation and reuse (within and outside the
collaborations):</li>
<li>Education on statistics procedures</li>
<li>Tool development: Statistical software updates can use real world
examples to test and debug their recent developments.</li>
<li>One can certainly find other use cases!</li>
</ul>
<p>The community report <em>“Publishing statistical models: Getting the
most out of particle physics experiments”</em>, SciPost Phys. 12, 037
(2022), <a href="https://arxiv.org/abs/2109.04981" class="external-link">arXiv:2109.04981</a>
makes the scientific case for statistical model publication, and discuss
technical developments.</p>
<p>In December 2023, CMS Collaboration took the decision to release
statistical models for all forthcoming analyses by default. This is in
accordance with <a href="https://cds.cern.ch/record/2745133" class="external-link">open access
policy of CERN</a> and the <a href="https://www.go-fair.org/fair-principles/" class="external-link">FAIR principles</a>
(findable, accessible, interoperable, reusable).</p>
<p>The first statistical model published is that for the Higgs boson
discovery. The model consists of the Run 1 combination of 5 main Higgs
channels (<a href="https://cms-results.web.cern.ch/cms-results/public-results/publications/HIG-12-028/index.html" class="external-link">CMS-HIG-12-028</a>).
The model can be found in <a href="https://repository.cern/records/c2948-e8875" class="external-link">this link</a>.</p>
<p>You can download the model into the Combine container and see the
discovery for yourself. The commands are available to combine channels,
calculate the significance, measure the signal strength modifier and
build a model as Higgs-vector boson, Higgs-fermion coupling modifiers as
POIs.</p>
<p>More models are on their way to become public soon!</p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-05-challenge"><p>Content from <a href="05-challenge.html">Limit calculation challenge</a></p>
<hr>
<p>Last updated on 2024-08-01 |

        <a href="https://github.com/cms-opendata-workshop/workbench-template-md/edit/main/episodes/05-challenge.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I write a Combine datacard for a counting analysis and for a
shape analysis?</li>
<li>How do I incorporate the effects of systematic uncertainties?</li>
<li>How do I calculate expected and observed limits?</li>
<li>How do I interpret the resulting limits?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Construct a Combine datacard for a counting analysis, learn to
modify systematics.</li>
<li>Construct a Combine datacard for a shape analysis, learn to modify
systematics.</li>
<li>Calculate limits using Combine with different methods for counting
and shape datacards and compare.</li>
<li>Understand what the limits mean.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The goal of this exercise is to use the <code>Combine</code> tool to
calculate limits from the results of the <span class="math inline">\(Z'\)</span> search studied in the previous
exercises. We will use the <code>Zprime_hists_FULL.root</code> file
generated during the <a href="https://cms-opendata-workshop.github.io/workshop2024-lesson-uncertainties/instructor/05-challenge.html" class="external-link">Uncertainties
challenge</a>. We will build various datacards from it, add systematics,
calculate limits on the signal strength modifier and understand the
output.</p>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Prerequisite<a class="anchor" aria-label="anchor" href="#prereq1"></a>
</h3>
<div class="callout-content">
<p>For the activities in this session you will need:</p>
<ul>
<li>Your Combine docker container (installation instructions provided in
the setup section of this tutorial)</li>
</ul>
</div>
</div>
</div>
<section><h2 class="section-heading" id="statistical-analysis-as-a-counting-experiment">Statistical analysis as a counting experiment<a class="anchor" aria-label="anchor" href="#statistical-analysis-as-a-counting-experiment"></a>
<a class="anchor" aria-label="anchor" href="#statistical-analysis-as-a-counting-experiment"></a>
</h2>
<hr class="half-width">
<p>At the end of the <a href="event%20selection%20exercise">https://cms-opendata-workshop.github.io/workshop2024-lesson-event-selection/</a>,
you applied a set of selection criteria to events that would enhance
<span class="math inline">\(Z'\)</span> signal from SM backgrounds.
Then you obtained the ttbar mass distributions for data, <span class="math inline">\(Z'\)</span> signal and a set of SM background
processes after this selection. In the <a href="https://cms-opendata-workshop.github.io/workshop2024-lesson-uncertainties/instructor/05-challenge.html" class="external-link">Uncertainties
challenge</a> exercise, you learned to obtain variations on these
distributions arising from certain systematic effects. In this first
exercise, we will treat the events surviving the selection as a single
quantity to perform a statistical analysis on a counting experiment. In
other words, we will collapse the <code>mtt</code> distributions into a
single “number of events” by integrating over all bins. Then we will use
these numbers obtained for all histograms, including those with
systematic variations, to build a counting experiment datacard.</p>
<p>First, start your Combine Docker container and make a working
directory:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">docker</span> start <span class="at">-i</span> combine</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">mkdir</span> /code/Zprime</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="bu">cd</span> /code/Zprime</span></code></pre>
</div>
<p>Download the <code>Zprime_hists_FULL.root</code> and the python
script to make the datacard:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">wget</span> https://github.com/cms-opendata-workshop/workshop2024-lesson-statistical-inference/raw/main/instructors//Zprime_hists_FULL.root</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">wget</span> https://github.com/cms-opendata-workshop/workshop2024-lesson-statistical-inference/raw/main/instructors//writecountdatacard.py</span></code></pre>
</div>
<p>You can look into the <code>writecountdatacard.py</code> script to
see how the datacard is written from the ROOT file. Run the script:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">python</span> writecountdatacard.py</span></code></pre>
</div>
<p>(ignore the output for the moment). Now look into
<code>datacard_counts.txt</code> and try to answer the following
questions:</p>
<div id="questions" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="questions" class="callout-inner">
<h3 class="callout-title">Questions<a class="anchor" aria-label="anchor" href="#questions"></a>
</h3>
<div class="callout-content">
<ul>
<li>Which is the background contributing most?</li>
<li>What can you say when you compare data, total backgrounds, and
signal counts?</li>
<li>Can you understand the effect of the various systematic
uncertainties?</li>
<li>Which systematic is expected to have the overall bigger impact?</li>
<li>Which process is affected most by systematics?</li>
</ul>
</div>
</div>
</div>
<p>Now run Combine over this datacard to obtain the limits on our
parameter of interest, signal strength modifier, with the simple
<code>AsymptoticLimits</code> option:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">combine</span> <span class="at">-M</span> AsymptoticLimits datacard_count.txt</span></code></pre>
</div>
<p>You will see some error messages concerning the computation of the
observed limit, arising from numerical stability issues. In order to
avoid this, let’s rerun by limiting the signal strength modifier to be
maximum 2:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">combine</span> <span class="at">-M</span> AsymptoticLimits datacard_count.txt <span class="at">--rMax</span><span class="op">=</span>2</span></code></pre>
</div>
<p>Look at the output, and try to answer the following:</p>
<div id="questions-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="questions-1" class="callout-inner">
<h3 class="callout-title">Questions<a class="anchor" aria-label="anchor" href="#questions-1"></a>
</h3>
<div class="callout-content">
<ul>
<li>What is the observed limit? What is the expected limit? What are the
uncertainties on the expected limit?</li>
<li>Did our analysis exclude this particular <span class="math inline">\(Z'\)</span> signal?</li>
<li>What can you say when you compare the values of the observed limit
with the expected limit?</li>
<li>What does it mean that the observed limit is much lower compared to
the expected limit? Does this make sense? <strong>Hint:</strong> Go back
to the datacard and look at the data, background and signal counts.</li>
</ul>
</div>
</div>
</div>
<div id="taming-the-observed-dont-try-this-at-home" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="taming-the-observed-dont-try-this-at-home" class="callout-inner">
<h3 class="callout-title">Taming the observed (DON’T TRY THIS AT HOME!)<a class="anchor" aria-label="anchor" href="#taming-the-observed-dont-try-this-at-home"></a>
</h3>
<div class="callout-content">
<p>A hypothetical question: What would bring the observed limit within
the expected uncertainties? Do the necessary modifications in the
datacard and see if the limit behaves as you predicted.</p>
<p>You can rerun <code>writecountdatacard.py</code> to reset the
datacard.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Observed limit is below the expected boundaries because we have much
more MC compared to data. This means there is less room for signal to be
accommodated in data, i.e. excluding signal becomes easier. If we had
more data, or less backgrounds, there would be more room for signal, and
the observed limit would be more consistent with the expected. So
hypothetically one could</p>
<ul>
<li>Increase the data counts, or</li>
<li>Decrease counts in one or more background processes.</li>
</ul>
<p>The point of this question was to increase the understanding. We
never do this in real life!!!</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="add-uncertainties-to-the-datacard">Add uncertainties to the datacard<a class="anchor" aria-label="anchor" href="#add-uncertainties-to-the-datacard"></a>
</h3>
<p>Now let’s add more uncertainties, both systematic and statistical.
Let’s start with adding a classic - the systematic uncertainty due to
luminosity measurement:</p>
<div id="challenge-add-a-lognormal-luminosity-systematic" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-add-a-lognormal-luminosity-systematic" class="callout-inner">
<h3 class="callout-title">Challenge: Add a lognormal luminosity systematic<a class="anchor" aria-label="anchor" href="#challenge-add-a-lognormal-luminosity-systematic"></a>
</h3>
<div class="callout-content">
<ul>
<li>Please add a lognormal systematic uncertainty on luminosity (called
<code>lumi</code>) that affects all signal and background processes,
inducing a symmetric 2.5% up and down variation.</li>
<li>Run Combine with the new datacard and discuss the effect on the
limits.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<pre><code>lumi            lnN        1.025          1.025          1.025          1.025          1.025</code></pre>
</div>
</div>
</div>
</div>
<p>Now let’s add a statistical uncertainty. Our signal and background
yields come from Monte Carlo, and the number of events could be limited,
resulting on non-negligible statistical uncertainties. We apply
<em>event weights</em> to these MC events so that the resulting rate
matches a certain value, e.g. cross section times the luminosity.
Statistical uncertainties are particularly relevant if both the yields
are small and the event weights are large (i.e. much less actual MC
events are available compared to the expected yield). Here is a quote
from the Combine documentation on how to take these into account:</p>
<p><em>“gmN stands for Gamma, and is the recommended choice for the
statistical uncertainty in a background determined from the number of
events in a control region (or in an MC sample with limited sample
size). If the control region or simulated sample contains N events, and
the extrapolation factor from the control region to the signal region is
α, one shoud put N just after the gmN keyword, and then the value of α
in the relevant (bin,process) column. The yield specified in the rate
line for this (bin,process) combination should equal Nα.”</em></p>
<p>Now let’s get back to the output we got from running
<code>writecountdatacard.py</code>. There you see the number of total
unweighted events, total weighted events and event weight for each
process.</p>
<div id="challenge-add-a-statistical-uncertainty" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-add-a-statistical-uncertainty" class="callout-inner">
<h3 class="callout-title">Challenge: Add a statistical uncertainty<a class="anchor" aria-label="anchor" href="#challenge-add-a-statistical-uncertainty"></a>
</h3>
<div class="callout-content">
<p>Look at the output of <code>writecountdatacard.py</code>:</p>
<ul>
<li>Which process has the largest event weight?</li>
<li>Can you incorporate the statistical uncertainty for that particular
process to the datacard?</li>
<li>Run Combine and discuss the effect on the limits.</li>
<li>OPTIONAL: You can add the statistical uncertainties for the other
processes as well and observe their effect on the limits.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<pre><code>stat_signal     gmN 48238  0.0307         -              -              -              -
stat_tt_semilep gmN 137080 -              0.0383         -              -              -
stat_tt_had     gmN 817    -              -              0.0636         -              -
stat_tt_lep     gmN 16134  -              -              -              0.0325         -
stat_wjets	gmN 19     -              -              -              -              15.1623</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="improve-the-limit">Improve the limit<a class="anchor" aria-label="anchor" href="#improve-the-limit"></a>
</h3>
<div id="improving-the-limit" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="improving-the-limit" class="callout-inner">
<h3 class="callout-title">Improving the limit<a class="anchor" aria-label="anchor" href="#improving-the-limit"></a>
</h3>
<div class="callout-content">
<p>What would you do to improve the limit here?</p>
<p><strong>Hint:</strong> Look at the original plot displaying the data,
background and signal distributions.</p>
<figure><img src="../fig/Zprimett_distr.png" style="width:60.0%" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<ul>
<li>In a count experiment setup, we can consider taking into account a
part of the <code>mtt</code> distribution where the signal is
dominant.</li>
<li>We can do a shape analysis, which takes into account each bin
separately.</li>
</ul>
</div>
</div>
</div>
</div>
<p>Let’s improve the limit in the couting experiment setup by computing
total counts considering only the last 25 bins out of the 50 total:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">python</span> writecountdatacard.py <span class="at">--startbin</span> 25 <span class="at">--stat</span> <span class="at">--lm</span></span></code></pre>
</div>
<p>We also added flags to automatically add the satistical and lumi
uncertainties :). How did the yields change? Did the limit improve? You
can try with different starting bin options to see how the limits
change.</p>
</div>
</section><section><h2 class="section-heading" id="shape-analysis">Shape analysis<a class="anchor" aria-label="anchor" href="#shape-analysis"></a>
<a class="anchor" aria-label="anchor" href="#shape-analysis"></a>
</h2>
<hr class="half-width">
<p>Now we move to a shape analysis, where each bin in the
<code>mtt</code> distribution is taken into account. Datacards for shape
analyses are built with similar principles as those for counting
analyses, but their syntax is slightly different. Here is the shape
datacard for the <span class="math inline">\(Z'\)</span>
analysis:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">wget</span> https://github.com/cms-opendata-workshop/workshop2024-lesson-statistical-inference/raw/main/instructors/datacard_shape.txt</span></code></pre>
</div>
<p>Examine it and note the differences in syntax. To run on Combine,
this datacard needs to be accompanied by the
<code>Zprime_hists_FULL.root</code> file, as the shapes are directly
retrieved from the histograms within.</p>
<p>Run Combine with this datacard. How do the limits compare with
respect to the counts case?</p>
<div id="limits-on-cross-section" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="limits-on-cross-section" class="callout-inner">
<h3 class="callout-title">Limits on cross section<a class="anchor" aria-label="anchor" href="#limits-on-cross-section"></a>
</h3>
<div class="callout-content">
<p>So far we have worked with limits on the signal strength modifier.
How can we compute the limits on cross section? Can you calculate the
upper limit on <span class="math inline">\(Z'\)</span> cross section
for this model?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>We can multiply the signal strength modifier limit with the
theoretically predicted cross section for the signal process.</p>
</div>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/cms-opendata-workshop/workbench-template-md/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/cms-opendata-workshop/workbench-template-md/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/cms-opendata-workshop/workbench-template-md/" class="external-link">Source</a></p>
				<p><a href="https://github.com/cms-opendata-workshop/workbench-template-md/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:cms-dpoa-coordinator@cern.ch">Contact</a> | <a href="https://opendata.cern.ch/docs/about-cms" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.5" class="external-link">sandpaper (0.16.5)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/cms-opendata-workshop/varnish/tree/405b7a74ee1b2fc89c3e49e116ce96d4d65182b3" class="external-link">varnish (1.0.3)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://cms-opendata-workshop.github.io/workbench-template-md/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "statistical inference, CMS, Combine, limit",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://cms-opendata-workshop.github.io/workbench-template-md/instructor/aio.html",
  "identifier": "https://cms-opendata-workshop.github.io/workbench-template-md/instructor/aio.html",
  "dateCreated": "2024-07-25",
  "dateModified": "2024-08-01",
  "datePublished": "2024-08-01"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

